# JPA 4. Entity Mapping



## 객체와 테이블 매핑

- 객체 : `@Entity`
- 테이블 : `@Table`
- 필드, 컬럼 : `@Column`
- 기본 키 : `@Id`
- 연관관계 : `@ManyToOne`, `@JoinColumn`



### `@Entity`

- 특징
  - JPA가 관리하는 것
- 주의
  - 기본 생성자가 있어야 한다.
  - final, enum, interface, inner 사용 금지
- 속성
  - name
    - 기본값으로 class 의 이름으로 간다.



###  `@Table`

- 엔티티와 매핑할 테이블을 지정하는 것
  - 데이터베이스의 명을 name 으로 설정하면 해당하는 이름을 지닌 데이터베이스와 맵핑해준다.



## 데이터 베이스 스키마 자동 생성

- 기능 

  - DDL 을 애플리케이션 로딩 시점에 자동으로 생성하는 기능
    - JPA 는 애플리케이션이 뜰 때, 필요한 것을 다 생성해준다.
  - 데이터베이스 방언을 활용해서 적절한 DDL을 생성시켜준다.
  - 물론 이렇게 생성된 DDL은 개발단계에서만 사용한다.
    - 절대 운영에서는 사용하지 말 것!

- 사용하기

  - ```properties
    <!--<property name="hibernate.hbm2ddl.auto" value="create" />-->
    ```

    - create
      - 기존 테이블 drop 후 create
      - 개발 초기 단계
    - create-drop
      - drop 후 create를 한다. 그리고 애플리케이션이 종료되면 다시 drop
      - 개발 초기 단계
    - update
      - 변경된 것만 반영하는 것
      - 지우는 것은 안된다! 추가하는 것만 된다.
      - 테스트 서버 (데이터가 추가만 된다!)
    - validate
      - 엔티티, 테이블이 정상 매핑되었는지 확인한다.
      - 테스트 서버, 스테이징, 운영서버
    - none
      - 이 기능 자체를 사용하지 않는 것
      - 매칭되는 것이 없으니 실행되지 않는다.
      - 테스트 서버, 스테이징, 운영서버

- 주의할 점
  - 사용하지 않는 것을 추천한다.
    - DB 자체를 아주 잘 아는 것으로 직접 하는 것도 좋지만, 이게 의도대로 잘 되지 않는다면 운영하는 서비스가 멈추는 큰 일이 벌어진다.
      그러므로 가급적이면 사용하지 않는 것을 추천한다.
      - alter table 같은 것도 잘못사용하면 테이블 락이 걸려서 잘 사용해야한다.



### DDL 생성 기능

- 제약조건 추가하기
  - `@Column(unique=true, length=10)`
    - `length=10` : 10글자 제한
- 특징
  - DDL 생성기능은 DDL을 자동생성할 때만 사용된다.
  - JPA 실행 로직에는 영향을 주지 않는다.





## 필드와 컬럼 매핑





## 기본 키 매핑